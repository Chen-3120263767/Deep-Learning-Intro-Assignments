# HWX3

本次任务利用kaggle上的brain-MRI数据进行训练分割任务。

## 训练细节

原始数据是没有分训练集和测试集的，我使用了sklearn模块的train_test_split函数划分，下载数据集时，解压缩得到kaggle3m和lgg-mri-segmentation/kaggle3m文件夹，这两个文件夹大小相同，似乎是一样的数据，于是我只使用了lgg-mri-segmentation/kaggle3m。

然后使用U-Net，U-Net的用法询问AI后显示似乎不需要保持原本的维度，直接256*256往下就可以了，在工程实际中似乎更常用。

## 训练优化

进行训练，为了提高性能，我主要处理细节有以下几点：

- 增加训练epoch数
- 引入scheduler在训练提升较小时调低学习率
- 使用混合损失函数，因为查阅资料显示衡量该任务完成好坏通常使用dice分数做为指标，于是我将dice损失和bce损失加权

## 一些训练结果

- 详细训练过程以及图像可以见notebook

- 为了防止过拟合，我曾试着在每次卷积加入0.1的dropout，训练出来模型能力很差，不知道是因为卷积不适合每层都加还是因为该任务受信息丢失影响较大，最终去掉了dropout。

- 最开始我dice损失赋予权重大，发现不太行，后来增加bce损失权重，效果才好起来。

- 训练过程中dice得分会有一个先震荡，再提升，然后趋于稳定的趋势，如果epoch不够多，观察不到该现象。